<?xml version="1.0" encoding="UTF-8"?>
<project version="4">
  <component name="CopilotDiffPersistence">
    <option name="pendingDiffs">
      <map>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/example/level_up_app/data/FavoritesRepository.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/example/level_up_app/data/FavoritesRepository.kt" />
              <option name="updatedContent" value="package com.example.level_up_app.data&#10;&#10;import androidx.compose.runtime.mutableStateListOf&#10;&#10;object FavoritesRepository {&#10;    private val _favorites = mutableStateListOf&lt;Product&gt;()&#10;    val favorites: List&lt;Product&gt; get() = _favorites&#10;&#10;    fun addToFavorites(product: Product) {&#10;        // Verificar si el producto ya está en favoritos&#10;        if (!_favorites.any { it.id == product.id }) {&#10;            _favorites.add(product)&#10;        }&#10;    }&#10;&#10;    fun removeFromFavorites(productId: String) {&#10;        _favorites.removeAll { it.id == productId }&#10;    }&#10;&#10;    fun isFavorite(productId: String): Boolean {&#10;        return _favorites.any { it.id == productId }&#10;    }&#10;&#10;    fun toggleFavorite(product: Product) {&#10;        if (isFavorite(product.id)) {&#10;            removeFromFavorites(product.id)&#10;        } else {&#10;            addToFavorites(product)&#10;        }&#10;    }&#10;}&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/example/level_up_app/ui/catalog/CatalogScreen.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/example/level_up_app/ui/catalog/CatalogScreen.kt" />
              <option name="originalContent" value="package com.example.level_up_app.ui.catalog&#10;&#10;import androidx.compose.foundation.layout.*&#10;import androidx.compose.foundation.lazy.LazyColumn&#10;import androidx.compose.foundation.lazy.items&#10;import androidx.compose.foundation.rememberScrollState&#10;import androidx.compose.foundation.shape.RoundedCornerShape&#10;import androidx.compose.foundation.verticalScroll&#10;import androidx.compose.material.icons.Icons&#10;import androidx.compose.material.icons.filled.Close&#10;import androidx.compose.material3.*&#10;import androidx.compose.runtime.*&#10;import androidx.compose.ui.Alignment&#10;import androidx.compose.ui.Modifier&#10;import androidx.compose.ui.draw.clip&#10;import androidx.compose.ui.layout.ContentScale&#10;import androidx.compose.ui.text.font.FontWeight&#10;import androidx.compose.ui.unit.dp&#10;import androidx.compose.ui.window.Dialog&#10;import androidx.compose.ui.window.DialogProperties&#10;import coil.compose.AsyncImage&#10;import com.example.level_up_app.data.Product&#10;import com.example.level_up_app.data.ProductRepository&#10;import com.example.level_up_app.data.CartRepository&#10;import kotlinx.coroutines.launch&#10;&#10;// Función para formatear precios en formato chileno&#10;fun formatPrice(price: Double): String {&#10;    val priceStr = price.toLong().toString()&#10;    return priceStr.reversed().chunked(3).joinToString(&quot;.&quot;).reversed()&#10;}&#10;&#10;@Composable&#10;fun CatalogScreen() {&#10;    var selectedProduct by remember { mutableStateOf&lt;Product?&gt;(null) }&#10;    val products = ProductRepository.products&#10;&#10;    Box(modifier = Modifier.fillMaxSize()) {&#10;        if (products.isEmpty()) {&#10;            Column(&#10;                modifier = Modifier&#10;                    .fillMaxSize()&#10;                    .padding(16.dp),&#10;                horizontalAlignment = Alignment.CenterHorizontally,&#10;                verticalArrangement = Arrangement.Center&#10;            ) {&#10;                Text(&#10;                    text = &quot;No hay productos en el catálogo&quot;,&#10;                    style = MaterialTheme.typography.titleMedium&#10;                )&#10;            }&#10;        } else {&#10;            LazyColumn(&#10;                modifier = Modifier.fillMaxSize(),&#10;                contentPadding = PaddingValues(16.dp),&#10;                verticalArrangement = Arrangement.spacedBy(12.dp)&#10;            ) {&#10;                items(products) { product -&gt;&#10;                    ProductCard(&#10;                        product = product,&#10;                        onClick = { selectedProduct = product }&#10;                    )&#10;                }&#10;            }&#10;        }&#10;    }&#10;&#10;    selectedProduct?.let { product -&gt;&#10;        ProductDetailDialog(&#10;            product = product,&#10;            onDismiss = { selectedProduct = null }&#10;        )&#10;    }&#10;}&#10;&#10;@Composable&#10;fun ProductCard(&#10;    product: Product,&#10;    onClick: () -&gt; Unit&#10;) {&#10;    Card(&#10;        modifier = Modifier.fillMaxWidth(),&#10;        elevation = CardDefaults.cardElevation(defaultElevation = 2.dp),&#10;        onClick = onClick&#10;    ) {&#10;        Row(&#10;            modifier = Modifier&#10;                .fillMaxWidth()&#10;                .padding(16.dp)&#10;        ) {&#10;            // Imagen del producto&#10;            if (product.imageUrl.isNotEmpty()) {&#10;                AsyncImage(&#10;                    model = product.imageUrl,&#10;                    contentDescription = product.name,&#10;                    modifier = Modifier&#10;                        .size(120.dp)&#10;                        .clip(RoundedCornerShape(8.dp)),&#10;                    contentScale = ContentScale.Crop&#10;                )&#10;                Spacer(modifier = Modifier.width(16.dp))&#10;            }&#10;&#10;            // Información del producto&#10;            Column(&#10;                modifier = Modifier.weight(1f)&#10;            ) {&#10;                Text(&#10;                    text = product.name,&#10;                    style = MaterialTheme.typography.titleMedium,&#10;                    fontWeight = FontWeight.Bold&#10;                )&#10;                if (product.category.isNotEmpty()) {&#10;                    Text(&#10;                        text = product.category,&#10;                        style = MaterialTheme.typography.bodySmall,&#10;                        color = MaterialTheme.colorScheme.secondary,&#10;                        modifier = Modifier.padding(top = 2.dp)&#10;                    )&#10;                }&#10;&#10;                if (product.description.isNotEmpty()) {&#10;                    Text(&#10;                        text = product.description,&#10;                        style = MaterialTheme.typography.bodyMedium,&#10;                        modifier = Modifier.padding(top = 8.dp),&#10;                        maxLines = 2&#10;                    )&#10;                }&#10;&#10;                Spacer(modifier = Modifier.height(8.dp))&#10;&#10;                Row(&#10;                    modifier = Modifier.fillMaxWidth(),&#10;                    horizontalArrangement = Arrangement.SpaceBetween,&#10;                    verticalAlignment = Alignment.Bottom&#10;                ) {&#10;                    Text(&#10;                        text = &quot;$${formatPrice(product.price)}&quot;,&#10;                        style = MaterialTheme.typography.titleLarge,&#10;                        color = MaterialTheme.colorScheme.primary,&#10;                        fontWeight = FontWeight.Bold&#10;                    )&#10;                    Text(&#10;                        text = &quot;Stock: ${product.stock}&quot;,&#10;                        style = MaterialTheme.typography.bodySmall,&#10;                        color = if (product.stock &gt; 10)&#10;                            MaterialTheme.colorScheme.onSurface&#10;                        else&#10;                            MaterialTheme.colorScheme.error&#10;                    )&#10;                }&#10;            }&#10;        }&#10;    }&#10;}&#10;&#10;@Composable&#10;fun ProductDetailDialog(&#10;    product: Product,&#10;    onDismiss: () -&gt; Unit&#10;) {&#10;    val snackbarHostState = remember { SnackbarHostState() }&#10;    val scope = rememberCoroutineScope()&#10;&#10;    Dialog(&#10;        onDismissRequest = onDismiss,&#10;        properties = DialogProperties(usePlatformDefaultWidth = false)&#10;    ) {&#10;        Card(&#10;            modifier = Modifier&#10;                .fillMaxWidth(0.95f)&#10;                .fillMaxHeight(0.85f),&#10;            shape = RoundedCornerShape(16.dp),&#10;            colors = CardDefaults.cardColors(&#10;                containerColor = MaterialTheme.colorScheme.surface&#10;            )&#10;        ) {&#10;            Box(modifier = Modifier.fillMaxSize()) {&#10;                Column(&#10;                    modifier = Modifier.fillMaxSize()&#10;                ) {&#10;                // Header con botón de cerrar&#10;                Row(&#10;                    modifier = Modifier&#10;                        .fillMaxWidth()&#10;                        .padding(16.dp),&#10;                    horizontalArrangement = Arrangement.SpaceBetween,&#10;                    verticalAlignment = Alignment.CenterVertically&#10;                ) {&#10;                    Text(&#10;                        text = &quot;Detalles del Producto&quot;,&#10;                        style = MaterialTheme.typography.titleLarge,&#10;                        fontWeight = FontWeight.Bold&#10;                    )&#10;                    IconButton(onClick = onDismiss) {&#10;                        Icon(&#10;                            Icons.Default.Close,&#10;                            contentDescription = &quot;Cerrar&quot;,&#10;                            tint = MaterialTheme.colorScheme.onSurface&#10;                        )&#10;                    }&#10;                }&#10;&#10;                HorizontalDivider()&#10;&#10;                // Contenido scrolleable&#10;                Column(&#10;                    modifier = Modifier&#10;                        .fillMaxSize()&#10;                        .verticalScroll(rememberScrollState())&#10;                        .padding(16.dp),&#10;                    verticalArrangement = Arrangement.spacedBy(16.dp)&#10;                ) {&#10;                    // Imagen del producto (más grande)&#10;                    if (product.imageUrl.isNotEmpty()) {&#10;                        AsyncImage(&#10;                            model = product.imageUrl,&#10;                            contentDescription = product.name,&#10;                            modifier = Modifier&#10;                                .fillMaxWidth()&#10;                                .height(250.dp)&#10;                                .clip(RoundedCornerShape(12.dp)),&#10;                            contentScale = ContentScale.Crop&#10;                        )&#10;                    }&#10;&#10;                    // Nombre del producto&#10;                    Text(&#10;                        text = product.name,&#10;                        style = MaterialTheme.typography.headlineMedium,&#10;                        fontWeight = FontWeight.Bold&#10;                    )&#10;&#10;                    // Categoría&#10;                    if (product.category.isNotEmpty()) {&#10;                        Card(&#10;                            colors = CardDefaults.cardColors(&#10;                                containerColor = MaterialTheme.colorScheme.secondaryContainer&#10;                            )&#10;                        ) {&#10;                            Text(&#10;                                text = product.category,&#10;                                style = MaterialTheme.typography.labelLarge,&#10;                                color = MaterialTheme.colorScheme.onSecondaryContainer,&#10;                                modifier = Modifier.padding(horizontal = 12.dp, vertical = 6.dp)&#10;                            )&#10;                        }&#10;                    }&#10;&#10;                    // Precio&#10;                    Row(&#10;                        modifier = Modifier.fillMaxWidth(),&#10;                        horizontalArrangement = Arrangement.SpaceBetween,&#10;                        verticalAlignment = Alignment.CenterVertically&#10;                    ) {&#10;                        Column {&#10;                            Text(&#10;                                text = &quot;Precio&quot;,&#10;                                style = MaterialTheme.typography.labelMedium,&#10;                                color = MaterialTheme.colorScheme.onSurfaceVariant&#10;                            )&#10;                            Text(&#10;                                text = &quot;$${formatPrice(product.price)}&quot;,&#10;                                style = MaterialTheme.typography.headlineLarge,&#10;                                color = MaterialTheme.colorScheme.primary,&#10;                                fontWeight = FontWeight.Bold&#10;                            )&#10;                        }&#10;&#10;                        // Stock&#10;                        Card(&#10;                            colors = CardDefaults.cardColors(&#10;                                containerColor = if (product.stock &gt; 10)&#10;                                    MaterialTheme.colorScheme.tertiaryContainer&#10;                                else&#10;                                    MaterialTheme.colorScheme.errorContainer&#10;                            )&#10;                        ) {&#10;                            Column(&#10;                                modifier = Modifier.padding(16.dp),&#10;                                horizontalAlignment = Alignment.CenterHorizontally&#10;                            ) {&#10;                                Text(&#10;                                    text = &quot;Stock Disponible&quot;,&#10;                                    style = MaterialTheme.typography.labelSmall,&#10;                                    color = if (product.stock &gt; 10)&#10;                                        MaterialTheme.colorScheme.onTertiaryContainer&#10;                                    else&#10;                                        MaterialTheme.colorScheme.onErrorContainer&#10;                                )&#10;                                Text(&#10;                                    text = &quot;${product.stock}&quot;,&#10;                                    style = MaterialTheme.typography.headlineMedium,&#10;                                    fontWeight = FontWeight.Bold,&#10;                                    color = if (product.stock &gt; 10)&#10;                                        MaterialTheme.colorScheme.onTertiaryContainer&#10;                                    else&#10;                                        MaterialTheme.colorScheme.onErrorContainer&#10;                                )&#10;                                Text(&#10;                                    text = &quot;unidades&quot;,&#10;                                    style = MaterialTheme.typography.labelSmall,&#10;                                    color = if (product.stock &gt; 10)&#10;                                        MaterialTheme.colorScheme.onTertiaryContainer&#10;                                    else&#10;                                        MaterialTheme.colorScheme.onErrorContainer&#10;                                )&#10;                            }&#10;                        }&#10;                    }&#10;&#10;                    // Descripción&#10;                    if (product.description.isNotEmpty()) {&#10;                        Column {&#10;                            Text(&#10;                                text = &quot;Descripción&quot;,&#10;                                style = MaterialTheme.typography.titleMedium,&#10;                                fontWeight = FontWeight.Bold,&#10;                                modifier = Modifier.padding(bottom = 8.dp)&#10;                            )&#10;                            Card(&#10;                                colors = CardDefaults.cardColors(&#10;                                    containerColor = MaterialTheme.colorScheme.surfaceVariant&#10;                                )&#10;                            ) {&#10;                                Text(&#10;                                    text = product.description,&#10;                                    style = MaterialTheme.typography.bodyLarge,&#10;                                    modifier = Modifier.padding(16.dp)&#10;                                )&#10;                            }&#10;                        }&#10;                    }&#10;&#10;                    // Botones de acción&#10;                    Row(&#10;                        modifier = Modifier&#10;                            .fillMaxWidth()&#10;                            .padding(top = 8.dp),&#10;                        horizontalArrangement = Arrangement.spacedBy(8.dp)&#10;                    ) {&#10;                        // Botón de Favoritos&#10;                        Button(&#10;                            onClick = {&#10;                                // TODO: Agregar a favoritos&#10;                            },&#10;                            modifier = Modifier.weight(1f),&#10;                            colors = ButtonDefaults.buttonColors(&#10;                                containerColor = MaterialTheme.colorScheme.secondary&#10;                            )&#10;                        ) {&#10;                            Text(&quot;Agregar a Favoritos&quot;)&#10;                        }&#10;&#10;                        // Botón de Añadir al Carrito&#10;                        Button(&#10;                            onClick = {&#10;                                CartRepository.addToCart(product)&#10;                                scope.launch {&#10;                                    snackbarHostState.showSnackbar(&#10;                                        message = &quot;✓ Producto agregado al carrito&quot;,&#10;                                        duration = SnackbarDuration.Short&#10;                                    )&#10;                                }&#10;                            },&#10;                            modifier = Modifier.weight(1f)&#10;                        ) {&#10;                            Text(&quot;Añadir al Carrito&quot;)&#10;                        }&#10;                    }&#10;                }&#10;                }&#10;&#10;                // SnackbarHost para mostrar mensajes&#10;                SnackbarHost(&#10;                    hostState = snackbarHostState,&#10;                    modifier = Modifier.align(Alignment.BottomCenter)&#10;                )&#10;            }&#10;        }&#10;    }&#10;}&#10;" />
              <option name="updatedContent" value="package com.example.level_up_app.ui.catalog&#10;&#10;import androidx.compose.foundation.layout.*&#10;import androidx.compose.foundation.lazy.LazyColumn&#10;import androidx.compose.foundation.lazy.items&#10;import androidx.compose.foundation.rememberScrollState&#10;import androidx.compose.foundation.shape.RoundedCornerShape&#10;import androidx.compose.foundation.verticalScroll&#10;import androidx.compose.material.icons.Icons&#10;import androidx.compose.material.icons.filled.Close&#10;import androidx.compose.material.icons.filled.Favorite&#10;import androidx.compose.material.icons.outlined.FavoriteBorder&#10;import androidx.compose.material3.*&#10;import androidx.compose.runtime.*&#10;import androidx.compose.ui.Alignment&#10;import androidx.compose.ui.Modifier&#10;import androidx.compose.ui.draw.clip&#10;import androidx.compose.ui.layout.ContentScale&#10;import androidx.compose.ui.text.font.FontWeight&#10;import androidx.compose.ui.unit.dp&#10;import androidx.compose.ui.window.Dialog&#10;import androidx.compose.ui.window.DialogProperties&#10;import coil.compose.AsyncImage&#10;import com.example.level_up_app.data.Product&#10;import com.example.level_up_app.data.ProductRepository&#10;import com.example.level_up_app.data.CartRepository&#10;import com.example.level_up_app.data.FavoritesRepository&#10;import kotlinx.coroutines.launch&#10;&#10;// Función para formatear precios en formato chileno&#10;fun formatPrice(price: Double): String {&#10;    val priceStr = price.toLong().toString()&#10;    return priceStr.reversed().chunked(3).joinToString(&quot;.&quot;).reversed()&#10;}&#10;&#10;@Composable&#10;fun CatalogScreen() {&#10;    var selectedProduct by remember { mutableStateOf&lt;Product?&gt;(null) }&#10;    val products = ProductRepository.products&#10;&#10;    Box(modifier = Modifier.fillMaxSize()) {&#10;        if (products.isEmpty()) {&#10;            Column(&#10;                modifier = Modifier&#10;                    .fillMaxSize()&#10;                    .padding(16.dp),&#10;                horizontalAlignment = Alignment.CenterHorizontally,&#10;                verticalArrangement = Arrangement.Center&#10;            ) {&#10;                Text(&#10;                    text = &quot;No hay productos en el catálogo&quot;,&#10;                    style = MaterialTheme.typography.titleMedium&#10;                )&#10;            }&#10;        } else {&#10;            LazyColumn(&#10;                modifier = Modifier.fillMaxSize(),&#10;                contentPadding = PaddingValues(16.dp),&#10;                verticalArrangement = Arrangement.spacedBy(12.dp)&#10;            ) {&#10;                items(products) { product -&gt;&#10;                    ProductCard(&#10;                        product = product,&#10;                        onClick = { selectedProduct = product }&#10;                    )&#10;                }&#10;            }&#10;        }&#10;    }&#10;&#10;    selectedProduct?.let { product -&gt;&#10;        ProductDetailDialog(&#10;            product = product,&#10;            onDismiss = { selectedProduct = null }&#10;        )&#10;    }&#10;}&#10;&#10;@Composable&#10;fun ProductCard(&#10;    product: Product,&#10;    onClick: () -&gt; Unit&#10;) {&#10;    Card(&#10;        modifier = Modifier.fillMaxWidth(),&#10;        elevation = CardDefaults.cardElevation(defaultElevation = 2.dp),&#10;        onClick = onClick&#10;    ) {&#10;        Row(&#10;            modifier = Modifier&#10;                .fillMaxWidth()&#10;                .padding(16.dp)&#10;        ) {&#10;            // Imagen del producto&#10;            if (product.imageUrl.isNotEmpty()) {&#10;                AsyncImage(&#10;                    model = product.imageUrl,&#10;                    contentDescription = product.name,&#10;                    modifier = Modifier&#10;                        .size(120.dp)&#10;                        .clip(RoundedCornerShape(8.dp)),&#10;                    contentScale = ContentScale.Crop&#10;                )&#10;                Spacer(modifier = Modifier.width(16.dp))&#10;            }&#10;&#10;            // Información del producto&#10;            Column(&#10;                modifier = Modifier.weight(1f)&#10;            ) {&#10;                Text(&#10;                    text = product.name,&#10;                    style = MaterialTheme.typography.titleMedium,&#10;                    fontWeight = FontWeight.Bold&#10;                )&#10;                if (product.category.isNotEmpty()) {&#10;                    Text(&#10;                        text = product.category,&#10;                        style = MaterialTheme.typography.bodySmall,&#10;                        color = MaterialTheme.colorScheme.secondary,&#10;                        modifier = Modifier.padding(top = 2.dp)&#10;                    )&#10;                }&#10;&#10;                if (product.description.isNotEmpty()) {&#10;                    Text(&#10;                        text = product.description,&#10;                        style = MaterialTheme.typography.bodyMedium,&#10;                        modifier = Modifier.padding(top = 8.dp),&#10;                        maxLines = 2&#10;                    )&#10;                }&#10;&#10;                Spacer(modifier = Modifier.height(8.dp))&#10;&#10;                Row(&#10;                    modifier = Modifier.fillMaxWidth(),&#10;                    horizontalArrangement = Arrangement.SpaceBetween,&#10;                    verticalAlignment = Alignment.Bottom&#10;                ) {&#10;                    Text(&#10;                        text = &quot;$${formatPrice(product.price)}&quot;,&#10;                        style = MaterialTheme.typography.titleLarge,&#10;                        color = MaterialTheme.colorScheme.primary,&#10;                        fontWeight = FontWeight.Bold&#10;                    )&#10;                    Text(&#10;                        text = &quot;Stock: ${product.stock}&quot;,&#10;                        style = MaterialTheme.typography.bodySmall,&#10;                        color = if (product.stock &gt; 10)&#10;                            MaterialTheme.colorScheme.onSurface&#10;                        else&#10;                            MaterialTheme.colorScheme.error&#10;                    )&#10;                }&#10;            }&#10;        }&#10;    }&#10;}&#10;&#10;@Composable&#10;fun ProductDetailDialog(&#10;    product: Product,&#10;    onDismiss: () -&gt; Unit&#10;) {&#10;    val snackbarHostState = remember { SnackbarHostState() }&#10;    val scope = rememberCoroutineScope()&#10;    var isFavorite by remember { mutableStateOf(FavoritesRepository.isFavorite(product.id)) }&#10;&#10;    Dialog(&#10;        onDismissRequest = onDismiss,&#10;        properties = DialogProperties(usePlatformDefaultWidth = false)&#10;    ) {&#10;        Card(&#10;            modifier = Modifier&#10;                .fillMaxWidth(0.95f)&#10;                .fillMaxHeight(0.85f),&#10;            shape = RoundedCornerShape(16.dp),&#10;            colors = CardDefaults.cardColors(&#10;                containerColor = MaterialTheme.colorScheme.surface&#10;            )&#10;        ) {&#10;            Box(modifier = Modifier.fillMaxSize()) {&#10;                Column(&#10;                    modifier = Modifier.fillMaxSize()&#10;                ) {&#10;                // Header con botón de cerrar&#10;                Row(&#10;                    modifier = Modifier&#10;                        .fillMaxWidth()&#10;                        .padding(16.dp),&#10;                    horizontalArrangement = Arrangement.SpaceBetween,&#10;                    verticalAlignment = Alignment.CenterVertically&#10;                ) {&#10;                    Text(&#10;                        text = &quot;Detalles del Producto&quot;,&#10;                        style = MaterialTheme.typography.titleLarge,&#10;                        fontWeight = FontWeight.Bold&#10;                    )&#10;                    IconButton(onClick = onDismiss) {&#10;                        Icon(&#10;                            Icons.Default.Close,&#10;                            contentDescription = &quot;Cerrar&quot;,&#10;                            tint = MaterialTheme.colorScheme.onSurface&#10;                        )&#10;                    }&#10;                }&#10;&#10;                HorizontalDivider()&#10;&#10;                // Contenido scrolleable&#10;                Column(&#10;                    modifier = Modifier&#10;                        .fillMaxSize()&#10;                        .verticalScroll(rememberScrollState())&#10;                        .padding(16.dp),&#10;                    verticalArrangement = Arrangement.spacedBy(16.dp)&#10;                ) {&#10;                    // Imagen del producto (más grande)&#10;                    if (product.imageUrl.isNotEmpty()) {&#10;                        AsyncImage(&#10;                            model = product.imageUrl,&#10;                            contentDescription = product.name,&#10;                            modifier = Modifier&#10;                                .fillMaxWidth()&#10;                                .height(250.dp)&#10;                                .clip(RoundedCornerShape(12.dp)),&#10;                            contentScale = ContentScale.Crop&#10;                        )&#10;                    }&#10;&#10;                    // Nombre del producto&#10;                    Text(&#10;                        text = product.name,&#10;                        style = MaterialTheme.typography.headlineMedium,&#10;                        fontWeight = FontWeight.Bold&#10;                    )&#10;&#10;                    // Categoría&#10;                    if (product.category.isNotEmpty()) {&#10;                        Card(&#10;                            colors = CardDefaults.cardColors(&#10;                                containerColor = MaterialTheme.colorScheme.secondaryContainer&#10;                            )&#10;                        ) {&#10;                            Text(&#10;                                text = product.category,&#10;                                style = MaterialTheme.typography.labelLarge,&#10;                                color = MaterialTheme.colorScheme.onSecondaryContainer,&#10;                                modifier = Modifier.padding(horizontal = 12.dp, vertical = 6.dp)&#10;                            )&#10;                        }&#10;                    }&#10;&#10;                    // Precio&#10;                    Row(&#10;                        modifier = Modifier.fillMaxWidth(),&#10;                        horizontalArrangement = Arrangement.SpaceBetween,&#10;                        verticalAlignment = Alignment.CenterVertically&#10;                    ) {&#10;                        Column {&#10;                            Text(&#10;                                text = &quot;Precio&quot;,&#10;                                style = MaterialTheme.typography.labelMedium,&#10;                                color = MaterialTheme.colorScheme.onSurfaceVariant&#10;                            )&#10;                            Text(&#10;                                text = &quot;$${formatPrice(product.price)}&quot;,&#10;                                style = MaterialTheme.typography.headlineLarge,&#10;                                color = MaterialTheme.colorScheme.primary,&#10;                                fontWeight = FontWeight.Bold&#10;                            )&#10;                        }&#10;&#10;                        // Stock&#10;                        Card(&#10;                            colors = CardDefaults.cardColors(&#10;                                containerColor = if (product.stock &gt; 10)&#10;                                    MaterialTheme.colorScheme.tertiaryContainer&#10;                                else&#10;                                    MaterialTheme.colorScheme.errorContainer&#10;                            )&#10;                        ) {&#10;                            Column(&#10;                                modifier = Modifier.padding(16.dp),&#10;                                horizontalAlignment = Alignment.CenterHorizontally&#10;                            ) {&#10;                                Text(&#10;                                    text = &quot;Stock Disponible&quot;,&#10;                                    style = MaterialTheme.typography.labelSmall,&#10;                                    color = if (product.stock &gt; 10)&#10;                                        MaterialTheme.colorScheme.onTertiaryContainer&#10;                                    else&#10;                                        MaterialTheme.colorScheme.onErrorContainer&#10;                                )&#10;                                Text(&#10;                                    text = &quot;${product.stock}&quot;,&#10;                                    style = MaterialTheme.typography.headlineMedium,&#10;                                    fontWeight = FontWeight.Bold,&#10;                                    color = if (product.stock &gt; 10)&#10;                                        MaterialTheme.colorScheme.onTertiaryContainer&#10;                                    else&#10;                                        MaterialTheme.colorScheme.onErrorContainer&#10;                                )&#10;                                Text(&#10;                                    text = &quot;unidades&quot;,&#10;                                    style = MaterialTheme.typography.labelSmall,&#10;                                    color = if (product.stock &gt; 10)&#10;                                        MaterialTheme.colorScheme.onTertiaryContainer&#10;                                    else&#10;                                        MaterialTheme.colorScheme.onErrorContainer&#10;                                )&#10;                            }&#10;                        }&#10;                    }&#10;&#10;                    // Descripción&#10;                    if (product.description.isNotEmpty()) {&#10;                        Column {&#10;                            Text(&#10;                                text = &quot;Descripción&quot;,&#10;                                style = MaterialTheme.typography.titleMedium,&#10;                                fontWeight = FontWeight.Bold,&#10;                                modifier = Modifier.padding(bottom = 8.dp)&#10;                            )&#10;                            Card(&#10;                                colors = CardDefaults.cardColors(&#10;                                    containerColor = MaterialTheme.colorScheme.surfaceVariant&#10;                                )&#10;                            ) {&#10;                                Text(&#10;                                    text = product.description,&#10;                                    style = MaterialTheme.typography.bodyLarge,&#10;                                    modifier = Modifier.padding(16.dp)&#10;                                )&#10;                            }&#10;                        }&#10;                    }&#10;&#10;                    // Botones de acción&#10;                    Row(&#10;                        modifier = Modifier&#10;                            .fillMaxWidth()&#10;                            .padding(top = 8.dp),&#10;                        horizontalArrangement = Arrangement.spacedBy(8.dp)&#10;                    ) {&#10;                        // Botón de Favoritos&#10;                        Button(&#10;                            onClick = {&#10;                                FavoritesRepository.toggleFavorite(product)&#10;                                isFavorite = FavoritesRepository.isFavorite(product.id)&#10;                                scope.launch {&#10;                                    snackbarHostState.showSnackbar(&#10;                                        message = if (isFavorite) &quot;♥ Agregado a favoritos&quot; else &quot;Eliminado de favoritos&quot;,&#10;                                        duration = SnackbarDuration.Short&#10;                                    )&#10;                                }&#10;                            },&#10;                            modifier = Modifier.weight(1f),&#10;                            colors = ButtonDefaults.buttonColors(&#10;                                containerColor = if (isFavorite) &#10;                                    MaterialTheme.colorScheme.error &#10;                                else &#10;                                    MaterialTheme.colorScheme.secondary&#10;                            )&#10;                        ) {&#10;                            Icon(&#10;                                imageVector = if (isFavorite) Icons.Filled.Favorite else Icons.Outlined.FavoriteBorder,&#10;                                contentDescription = null,&#10;                                modifier = Modifier.size(20.dp)&#10;                            )&#10;                            Spacer(modifier = Modifier.width(4.dp))&#10;                            Text(if (isFavorite) &quot;En Favoritos&quot; else &quot;Agregar a Favoritos&quot;)&#10;                        }&#10;&#10;                        // Botón de Añadir al Carrito&#10;                        Button(&#10;                            onClick = {&#10;                                CartRepository.addToCart(product)&#10;                                scope.launch {&#10;                                    snackbarHostState.showSnackbar(&#10;                                        message = &quot;✓ Producto agregado al carrito&quot;,&#10;                                        duration = SnackbarDuration.Short&#10;                                    )&#10;                                }&#10;                            },&#10;                            modifier = Modifier.weight(1f)&#10;                        ) {&#10;                            Text(&quot;Añadir al Carrito&quot;)&#10;                        }&#10;                    }&#10;                }&#10;                }&#10;&#10;                // SnackbarHost para mostrar mensajes&#10;                SnackbarHost(&#10;                    hostState = snackbarHostState,&#10;                    modifier = Modifier.align(Alignment.BottomCenter)&#10;                )&#10;            }&#10;        }&#10;    }&#10;}&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
        <entry key="$PROJECT_DIR$/app/src/main/java/com/example/level_up_app/ui/menu/MainMenu.kt">
          <value>
            <PendingDiffInfo>
              <option name="filePath" value="$PROJECT_DIR$/app/src/main/java/com/example/level_up_app/ui/menu/MainMenu.kt" />
              <option name="originalContent" value="package com.example.level_up_app.ui.menu&#10;&#10;import androidx.compose.foundation.layout.Box&#10;import androidx.compose.foundation.layout.fillMaxSize&#10;import androidx.compose.foundation.layout.padding&#10;import androidx.compose.material.icons.Icons&#10;import androidx.compose.material.icons.filled.Favorite&#10;import androidx.compose.material.icons.filled.ShoppingCart&#10;import androidx.compose.material.icons.outlined.FavoriteBorder&#10;import androidx.compose.material.icons.outlined.ShoppingCart&#10;import androidx.compose.material3.CenterAlignedTopAppBar&#10;import androidx.compose.material3.ExperimentalMaterial3Api&#10;import androidx.compose.material3.Icon&#10;import androidx.compose.material3.IconButton&#10;import androidx.compose.material3.Scaffold&#10;import androidx.compose.material3.Text&#10;import androidx.compose.runtime.Composable&#10;import androidx.compose.runtime.getValue&#10;import androidx.compose.runtime.mutableStateOf&#10;import androidx.compose.runtime.remember&#10;import androidx.compose.runtime.setValue&#10;import androidx.compose.ui.Alignment&#10;import androidx.compose.ui.Modifier&#10;import com.example.level_up_app.ui.catalog.CatalogScreen&#10;import com.example.level_up_app.ui.cart.CartScreen&#10;import com.example.level_up_app.ui.components.BottomNavBar&#10;import com.example.level_up_app.ui.news.NewsScreen&#10;import com.example.level_up_app.ui.profile.ProfileEditScreen&#10;import com.example.level_up_app.ui.profile.ProfileScreen&#10;import com.example.level_up_app.ui.main.HomeScreen&#10;import com.example.level_up_app.ui.favorites.FavoritesScreen&#10;import com.example.level_up_app.buys.PayScreen&#10;import com.example.level_up_app.buys.PayResultScreen&#10;import com.example.level_up_app.screen.Fondo_2&#10;import androidx.compose.ui.platform.LocalContext&#10;import com.example.level_up_app.utils.SessionManager&#10;&#10;@OptIn(ExperimentalMaterial3Api::class)&#10;@Composable&#10;fun MainMenu(&#10;    onProfile: () -&gt; Unit = {}&#10;) {&#10;    val context = LocalContext.current&#10;    val sessionManager = remember { SessionManager(context) }&#10;    var currentUser by remember { mutableStateOf(sessionManager.getUser()) }&#10;&#10;    var selectedIndex by remember { mutableStateOf(0) }&#10;    var isEditing by remember { mutableStateOf(false) }&#10;    // nuevo estado: resultado del último pago (null = aún no se ha hecho)&#10;    var lastPaymentSuccess by remember { mutableStateOf&lt;Boolean?&gt;(null) }&#10;    val currentScreen =&#10;&#10;        when (selectedIndex) {&#10;        0 -&gt; &quot;Inicio&quot;&#10;        1 -&gt; &quot;Catalogo&quot;&#10;        2 -&gt; &quot;Noticias&quot;&#10;        3 -&gt; &quot;Perfil&quot;&#10;        4 -&gt; &quot;Favoritos&quot;&#10;        5 -&gt; &quot;Carrito&quot;&#10;        6 -&gt; &quot;Pago&quot;&#10;        7 -&gt; &quot;Resultado pago&quot;&#10;        else -&gt; &quot;&quot;&#10;    }&#10;&#10;    Scaffold(&#10;&#10;        topBar = {&#10;            CenterAlignedTopAppBar(&#10;                title = { Text(currentScreen.uppercase()) },&#10;                actions = {&#10;                    IconButton(onClick = { selectedIndex = 4 }) {&#10;                        Icon(&#10;                            imageVector = if (selectedIndex == 4) Icons.Filled.Favorite else Icons.Outlined.FavoriteBorder,&#10;                            contentDescription = &quot;Favoritos&quot;&#10;                        )&#10;                    }&#10;                    IconButton(onClick = { selectedIndex = 5 }) {&#10;                        Icon(&#10;                            imageVector = if (selectedIndex == 5) Icons.Filled.ShoppingCart else Icons.Outlined.ShoppingCart,&#10;                            contentDescription = &quot;Carrito&quot;&#10;                        )&#10;                    }&#10;                }&#10;            )&#10;        },&#10;         // when user selects another tab, make sure we leave edit mode&#10;         bottomBar = { BottomNavBar(selectedIndex = selectedIndex, onItemSelected = { index -&gt;&#10;             selectedIndex = index&#10;             if (index != 3) isEditing = false&#10;         }, onProfile = onProfile) }&#10;&#10;    ) { innerPadding -&gt;&#10;        Box(&#10;            modifier = Modifier&#10;                .fillMaxSize()&#10;                .padding(innerPadding)&#10;        ) {&#10;            Fondo_2()&#10;            when (selectedIndex) {&#10;                0 -&gt; HomeScreen()&#10;                1 -&gt; CatalogScreen()&#10;                2 -&gt; NewsScreen()&#10;                4 -&gt; FavoritesScreen()&#10;                5 -&gt; CartScreen(onNavigateToPay = { selectedIndex = 6 })&#10;                6 -&gt; PayScreen(&#10;                    onCancel = { selectedIndex = 0 },&#10;                    onSuccess = {&#10;                        lastPaymentSuccess = true&#10;                        selectedIndex = 7&#10;                    },&#10;                    onFailure = {&#10;                        lastPaymentSuccess = false&#10;                        selectedIndex = 7&#10;                    }&#10;                )&#10;                7 -&gt; PayResultScreen(&#10;                    isSuccess = (lastPaymentSuccess == true),&#10;                    onRetry = {&#10;                        // al reintentar limpiamos el estado y volvemos a la pantalla de pago&#10;                        lastPaymentSuccess = null&#10;                        selectedIndex = 6&#10;                    },&#10;                    onGoHome = {&#10;                        lastPaymentSuccess = null&#10;                        selectedIndex = 0&#10;                    }&#10;                )&#10;                3 -&gt; {&#10;                    if (isEditing) {&#10;                        ProfileEditScreen(&#10;                            onSave = { _, _, _ -&gt; /* no-op for now */ },&#10;                            onBack = {&#10;                                isEditing = false&#10;                                // Recargar los datos del usuario desde la sesión actualizada&#10;                                currentUser = sessionManager.getUser()&#10;                            }&#10;                        )&#10;                    } else {&#10;                        ProfileScreen(&#10;                            name = currentUser?.name ?: &quot;&quot;,&#10;                            email = currentUser?.email ?: &quot;&quot;,&#10;                            onEditClicked = { isEditing = true }&#10;                        )&#10;                    }&#10;                }&#10;                else -&gt; {&#10;                    Box(&#10;                        modifier = Modifier.fillMaxSize(),&#10;                        contentAlignment = Alignment.Center&#10;                    ) {&#10;                        Text(&quot;Pantalla: $currentScreen&quot;)&#10;                    }&#10;                }&#10;            }&#10;         }&#10;     }&#10; }&#10;" />
              <option name="updatedContent" value="package com.example.level_up_app.ui.menu&#10;&#10;import androidx.compose.foundation.layout.Box&#10;import androidx.compose.foundation.layout.fillMaxSize&#10;import androidx.compose.foundation.layout.padding&#10;import androidx.compose.material.icons.Icons&#10;import androidx.compose.material.icons.filled.Favorite&#10;import androidx.compose.material.icons.filled.ShoppingCart&#10;import androidx.compose.material.icons.filled.Star&#10;import androidx.compose.material.icons.outlined.FavoriteBorder&#10;import androidx.compose.material.icons.outlined.ShoppingCart&#10;import androidx.compose.material3.CenterAlignedTopAppBar&#10;import androidx.compose.material3.ExperimentalMaterial3Api&#10;import androidx.compose.material3.Icon&#10;import androidx.compose.material3.IconButton&#10;import androidx.compose.material3.Scaffold&#10;import androidx.compose.material3.Text&#10;import androidx.compose.runtime.Composable&#10;import androidx.compose.runtime.getValue&#10;import androidx.compose.runtime.mutableStateOf&#10;import androidx.compose.runtime.remember&#10;import androidx.compose.runtime.setValue&#10;import androidx.compose.ui.Alignment&#10;import androidx.compose.ui.Modifier&#10;import com.example.level_up_app.ui.catalog.CatalogScreen&#10;import com.example.level_up_app.ui.cart.CartScreen&#10;import com.example.level_up_app.ui.components.BottomNavBar&#10;import com.example.level_up_app.ui.news.NewsScreen&#10;import com.example.level_up_app.ui.profile.ProfileEditScreen&#10;import com.example.level_up_app.ui.profile.ProfileScreen&#10;import com.example.level_up_app.ui.main.HomeScreen&#10;import com.example.level_up_app.ui.favorites.FavoritesScreen&#10;import com.example.level_up_app.buys.PayScreen&#10;import com.example.level_up_app.buys.PayResultScreen&#10;import com.example.level_up_app.screen.Fondo_2&#10;import androidx.compose.ui.platform.LocalContext&#10;import com.example.level_up_app.utils.SessionManager&#10;&#10;@OptIn(ExperimentalMaterial3Api::class)&#10;@Composable&#10;fun MainMenu(&#10;    onProfile: () -&gt; Unit = {}&#10;) {&#10;    val context = LocalContext.current&#10;    val sessionManager = remember { SessionManager(context) }&#10;    var currentUser by remember { mutableStateOf(sessionManager.getUser()) }&#10;&#10;    var selectedIndex by remember { mutableStateOf(0) }&#10;    var isEditing by remember { mutableStateOf(false) }&#10;    // nuevo estado: resultado del último pago (null = aún no se ha hecho)&#10;    var lastPaymentSuccess by remember { mutableStateOf&lt;Boolean?&gt;(null) }&#10;    val currentScreen =&#10;&#10;        when (selectedIndex) {&#10;        0 -&gt; &quot;Inicio&quot;&#10;        1 -&gt; &quot;Catalogo&quot;&#10;        2 -&gt; &quot;Noticias&quot;&#10;        3 -&gt; &quot;Perfil&quot;&#10;        4 -&gt; &quot;Favoritos&quot;&#10;        5 -&gt; &quot;Carrito&quot;&#10;        6 -&gt; &quot;Pago&quot;&#10;        7 -&gt; &quot;Resultado pago&quot;&#10;        else -&gt; &quot;&quot;&#10;    }&#10;&#10;    Scaffold(&#10;        topBar = {&#10;            CenterAlignedTopAppBar(&#10;                title = { Text(currentScreen.uppercase()) },&#10;                navigationIcon = {&#10;                    // Menú de administrador (solo si es admin)&#10;                    if (currentUser?.isAdmin == true) {&#10;                        var showAdminMenu by remember { mutableStateOf(false) }&#10;                        &#10;                        IconButton(onClick = { showAdminMenu = true }) {&#10;                            Icon(&#10;                                imageVector = Icons.Filled.Star,&#10;                                contentDescription = &quot;Panel de Administración&quot;&#10;                            )&#10;                        }&#10;                        &#10;                        androidx.compose.material3.DropdownMenu(&#10;                            expanded = showAdminMenu,&#10;                            onDismissRequest = { showAdminMenu = false }&#10;                        ) {&#10;                            androidx.compose.material3.DropdownMenuItem(&#10;                                text = { Text(&quot;Administrar Productos&quot;) },&#10;                                onClick = {&#10;                                    showAdminMenu = false&#10;                                    // TODO: Navegar a administración de productos&#10;                                }&#10;                            )&#10;                            androidx.compose.material3.DropdownMenuItem(&#10;                                text = { Text(&quot;Administrar Usuarios&quot;) },&#10;                                onClick = {&#10;                                    showAdminMenu = false&#10;                                    // TODO: Navegar a administración de usuarios&#10;                                }&#10;                            )&#10;                            androidx.compose.material3.DropdownMenuItem(&#10;                                text = { Text(&quot;Administrar Noticias&quot;) },&#10;                                onClick = {&#10;                                    showAdminMenu = false&#10;                                    // TODO: Navegar a administración de noticias&#10;                                }&#10;                            )&#10;                        }&#10;                    }&#10;                },&#10;                actions = {&#10;                    IconButton(onClick = { selectedIndex = 4 }) {&#10;                        Icon(&#10;                            imageVector = if (selectedIndex == 4) Icons.Filled.Favorite else Icons.Outlined.FavoriteBorder,&#10;                            contentDescription = &quot;Favoritos&quot;&#10;                        )&#10;                    }&#10;                    IconButton(onClick = { selectedIndex = 5 }) {&#10;                        Icon(&#10;                            imageVector = if (selectedIndex == 5) Icons.Filled.ShoppingCart else Icons.Outlined.ShoppingCart,&#10;                            contentDescription = &quot;Carrito&quot;&#10;                        )&#10;                    }&#10;                }&#10;            )&#10;        },&#10;         // when user selects another tab, make sure we leave edit mode&#10;         bottomBar = { BottomNavBar(selectedIndex = selectedIndex, onItemSelected = { index -&gt;&#10;             selectedIndex = index&#10;             if (index != 3) isEditing = false&#10;         }, onProfile = onProfile) }&#10;&#10;    ) { innerPadding -&gt;&#10;        Box(&#10;            modifier = Modifier&#10;                .fillMaxSize()&#10;                .padding(innerPadding)&#10;        ) {&#10;            Fondo_2()&#10;            when (selectedIndex) {&#10;                0 -&gt; HomeScreen()&#10;                1 -&gt; CatalogScreen()&#10;                2 -&gt; NewsScreen()&#10;                4 -&gt; FavoritesScreen()&#10;                5 -&gt; CartScreen(onNavigateToPay = { selectedIndex = 6 })&#10;                6 -&gt; PayScreen(&#10;                    onCancel = { selectedIndex = 0 },&#10;                    onSuccess = {&#10;                        lastPaymentSuccess = true&#10;                        selectedIndex = 7&#10;                    },&#10;                    onFailure = {&#10;                        lastPaymentSuccess = false&#10;                        selectedIndex = 7&#10;                    }&#10;                )&#10;                7 -&gt; PayResultScreen(&#10;                    isSuccess = (lastPaymentSuccess == true),&#10;                    onRetry = {&#10;                        // al reintentar limpiamos el estado y volvemos a la pantalla de pago&#10;                        lastPaymentSuccess = null&#10;                        selectedIndex = 6&#10;                    },&#10;                    onGoHome = {&#10;                        lastPaymentSuccess = null&#10;                        selectedIndex = 0&#10;                    }&#10;                )&#10;                3 -&gt; {&#10;                    if (isEditing) {&#10;                        ProfileEditScreen(&#10;                            onSave = { _, _, _ -&gt; /* no-op for now */ },&#10;                            onBack = {&#10;                                isEditing = false&#10;                                // Recargar los datos del usuario desde la sesión actualizada&#10;                                currentUser = sessionManager.getUser()&#10;                            }&#10;                        )&#10;                    } else {&#10;                        ProfileScreen(&#10;                            name = currentUser?.name ?: &quot;&quot;,&#10;                            email = currentUser?.email ?: &quot;&quot;,&#10;                            onEditClicked = { isEditing = true }&#10;                        )&#10;                    }&#10;                }&#10;                else -&gt; {&#10;                    Box(&#10;                        modifier = Modifier.fillMaxSize(),&#10;                        contentAlignment = Alignment.Center&#10;                    ) {&#10;                        Text(&quot;Pantalla: $currentScreen&quot;)&#10;                    }&#10;                }&#10;            }&#10;         }&#10;     }&#10; }&#10;" />
            </PendingDiffInfo>
          </value>
        </entry>
      </map>
    </option>
  </component>
</project>